<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Tharoor It | Scholarstree</title>
<meta name="keywords" content="nlp">
<meta name="description" content="An application to calculate Tharoorian probability of some text.">
<meta name="author" content="">
<link rel="canonical" href="https://scholarstree.github.io/posts/2018-04-27-tharoor-it/2018-04-27-tharoor-it/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.f2fd8ad7799e4ffbe9524adbf69f2789525e44b8d40c13b4a83d68bd4981fc8d.css" integrity="sha256-8v2K13meT/vpUkrb9p8niVJeRLjUDBO0qD1ovUmB/I0=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://scholarstree.github.io/favicon.ico">
<link rel="apple-touch-icon" href="https://scholarstree.github.io/apple-touch-icon.png">

<meta name="twitter:title" content="Tharoor It | Scholarstree" />
<meta name="twitter:description" content="An application to calculate Tharoorian probability of some text." />
<meta property="og:title" content="Tharoor It | Scholarstree" />
<meta property="og:description" content="An application to calculate Tharoorian probability of some text." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://scholarstree.github.io/posts/2018-04-27-tharoor-it/2018-04-27-tharoor-it/" />
<meta property="article:section" content="posts" />
  <meta property="article:published_time" content="2018-04-27T12:00:00&#43;05:30" />
  <meta property="article:modified_time" content="2018-04-27T12:00:00&#43;05:30" />


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://scholarstree.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Tharoor It",
      "item": "https://scholarstree.github.io/posts/2018-04-27-tharoor-it/2018-04-27-tharoor-it/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Tharoor It | Scholarstree",
  "name": "Tharoor It",
  "description": "An application to calculate Tharoorian probability of some text.",
  "keywords": [
    "nlp"
  ],
  "wordCount" : "560",
  "inLanguage": "en",
  "datePublished": "2018-04-27T12:00:00+05:30",
  "dateModified": "2018-04-27T12:00:00+05:30",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://scholarstree.github.io/posts/2018-04-27-tharoor-it/2018-04-27-tharoor-it/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Scholarstree",
    "logo": {
      "@type": "ImageObject",
      "url": "https://scholarstree.github.io/favicon.ico"
    }
  }
}
</script>



<style>
    #icons {
      display: flex;
      flex-wrap: wrap;
      margin-top: 2em;
    }
    #icons .item {
      width: 80px;
      height: 50px;
      margin: 10px;
    }
    #icons .item .name {
      font-size: 12px;
      user-select: all;
      text-align: center;
    }
    #icons .item .icon {
      display: flex;
      justify-content: center;
    }
    #icons .item svg {
      width: 30px;
      height: 30px;
    }
  </style>
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary-bg: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list-page {
                background: var(--theme);
            }

            .list-page:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list-page:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

</head>

<body class=" type-posts kind-page layout-post" id="top"><script data-no-instant>
function switchTheme(theme) {
  switch (theme) {
    case 'light':
      document.body.classList.remove('dark');
      break;
    case 'dark':
      document.body.classList.add('dark');
      break;
    
    default:
      if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
      }
  }
}

function isDarkTheme() {
  return document.body.className.includes("dark");
}

function getPrefTheme() {
  return localStorage.getItem("pref-theme");
}

function setPrefTheme(theme) {
  switchTheme(theme)
  localStorage.setItem("pref-theme", theme);
}

const toggleThemeCallbacks = {}
toggleThemeCallbacks['main'] = (isDark) => {
  
  if (isDark) {
    setPrefTheme('light');
  } else {
    setPrefTheme('dark');
  }
}




window.addEventListener('toggle-theme', function() {
  
  const isDark = isDarkTheme()
  for (const key in toggleThemeCallbacks) {
    toggleThemeCallbacks[key](isDark)
  }
});


function toggleThemeListener() {
  
  window.dispatchEvent(new CustomEvent('toggle-theme'));
}

</script>
<script>
  
  (function() {
    const defaultTheme = 'auto';
    const prefTheme = getPrefTheme();
    const theme = prefTheme ? prefTheme : defaultTheme;

    switchTheme(theme);
  })();
</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://scholarstree.github.io/" accesskey="h" title="Scholarstree (Alt + H)">Scholarstree</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://scholarstree.github.io/categories/" title="Categories"
                >Categories
                </a>
            </li>
            <li>
                <a href="https://scholarstree.github.io/tags/" title="Tags"
                >Tags
                </a>
            </li>
            <li>
                <a href="https://scholarstree.github.io/archives/" title="Archive"
                >Archive
                </a>
            </li>
            <li>
                <a href="https://scholarstree.github.io/search/" title="Search (Alt &#43; /)"data-no-instant accesskey=/
                >Search
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main post">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://scholarstree.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://scholarstree.github.io/posts/">Posts</a></div><h1 class="post-title">Tharoor It</h1>
    <div class="post-description">An application to calculate Tharoorian probability of some text.</div>
    <div class="post-meta"><span class="meta-item">
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar" style="user-select: text;"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" style="user-select: text;"></rect><line x1="16" y1="2" x2="16" y2="6" style="user-select: text;"></line><line x1="8" y1="2" x2="8" y2="6" style="user-select: text;"></line><line x1="3" y1="10" x2="21" y2="10" style="user-select: text;"></line></svg>
  <span>April 27, 2018</span></span><span class="meta-item">
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon" style="user-select: text;"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z" style="user-select: text;"></path><line x1="7" y1="7" x2="7" y2="7" style="user-select: text;"></line></svg>
  <span class="post-tags"><a href="https://scholarstree.github.io/tags/nlp/">nlp</a></span></span><span class="meta-item">
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><circle cx="12" cy="12" r="9"></circle><polyline points="12 7 12 12 15 15"></polyline></svg>
  <span>3 min</span></span>

      
      
    </div>
  </header> <div class="toc side left">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#dataset" aria-label="Dataset">Dataset</a></li>
                <li>
                    <a href="#model" aria-label="Model">Model</a></li>
                <li>
                    <a href="#results" aria-label="Results">Results</a></li>
                <li>
                    <a href="#conclusion" aria-label="Conclusion">Conclusion</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><figure class="align-center ">
    <img loading="lazy" src="/2018-04-27-tharoor-it/tharoor_it.png#center"
         alt="tsne_title"/> 
</figure>

<hr>
<p>I had recently started reading <a href="https://www.goodreads.com/book/show/32618967-an-era-of-darkness">An Era of Darkness: The British Empire in India</a> and was dazzled by <a href="http://www.shashitharoor.in/">Dr. Tharoor</a>&rsquo;s wizardry of words. He calls himself an amateur historian while painting an honest picture of British Raj in India. I was mesmerized by his writing and wondered if any underlying pattern could be found using Deep Learning. Hackfest, our annual college hackathon was also approaching around the time, so I decided to execute a project related to Dr. Tharoor&rsquo;s literature in 36 hours. So when the contest started, we were trying to build a Tharoorian text classifier.</p>
<p>We planned to make a lightweight web application capable of taking a piece of text as input and estimating the probability of it being written by Dr. Tharoor. We were aware that it would be impossible to make a deployable model in just 36 hours. Nevertheless, we worked out a plan - Gather and process data, train a model, deploy on a local server and keep improving the model.</p>
<h3 id="dataset">Dataset</h3>
<p>We collected 10 of Dr. Tharoor&rsquo;s published books, extracted ~30,000 sentences and labeled them as 1 while  manually removing short sentences consisting of only a few words. We randomly picked some books for negative samples and labeled ~200,000 sentences as 0. <a href="https://nlp.stanford.edu/projects/glove/">100d GloVe embeddings</a> were used for creating the embedding matrix - vector representation of words in the dataset.</p>
<table>
<thead>
<tr>
<th>Sentence</th>
<th style="text-align:center">Label</th>
</tr>
</thead>
<tbody>
<tr>
<td>The British Raj is scarcely ancient history.</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td>The reason was simple: India was governed for the benefit of Britain.</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td>By breaking the law non-violently he showed up the injustice of the law.</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td>This is not my fault.</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td>Grown-ups never understand anything by themselves, and it is exhausting for children to have to explain over and over again.</td>
<td style="text-align:center">0</td>
</tr>
</tbody>
</table>
<h3 id="model">Model</h3>
<p>We decided to use a Bidirectional <a href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/">LSTM</a> for our purpose. Although we also tried 1D Convolutions which produced funny results. Training a bi-LSTM netowrk took 1 hour on our GPU. After our Keras model was trained, we exported it into a <code>.h5</code> file and used a flask server to <a href="https://blog.keras.io/building-a-simple-keras-deep-learning-rest-api.html">deploy it</a> to a local server.</p>
<h3 id="results">Results</h3>
<p>Although our model was a simple LSTM network without any attention, it gave decent predictions. Since the input to our network were single sentences only, it mostly depended upon presence of words to make predictions. Our training dataset only consisted of his books which kind of restricted our model&rsquo;s ability. Perhaps adding more data and using attention models would have given better results.</p>
<table>
<thead>
<tr>
<th>Sentence</th>
<th style="text-align:center">Prediction(%)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Earth is flat.</td>
<td style="text-align:center">49.42</td>
</tr>
<tr>
<td>I will build a great, great wall on our southern border, and I will have Mexico pay for that wall. Mark my words.</td>
<td style="text-align:center">84.38</td>
</tr>
<tr>
<td>There was an idea to bring together a group of remarkable people, so when we needed them, they could fight the battles that we never could.</td>
<td style="text-align:center">96.64</td>
</tr>
<tr>
<td>Exasperating farrago of distortions, misrepresentations &amp; outright lies being broadcast by an unprincipled showman masquerading as a journalist.</td>
<td style="text-align:center">87.03</td>
</tr>
<tr>
<td>Albus Dumbledore didn&rsquo;t seem to realize that he had just arrived in a street where everything from his name to his boots was unwelcome.</td>
<td style="text-align:center">0.05</td>
</tr>
<tr>
<td>The sheep are running wild.</td>
<td style="text-align:center">2.83</td>
</tr>
<tr>
<td>History is boring.</td>
<td style="text-align:center">90.49</td>
</tr>
<tr>
<td>Physics is boring.</td>
<td style="text-align:center">37.65</td>
</tr>
<tr>
<td>I is extremely tired of reading history.</td>
<td style="text-align:center">22.47</td>
</tr>
</tbody>
</table>
<h3 id="conclusion">Conclusion</h3>
<p>Our team secured 6th rank out of ~50 participants. Along with this project, we also attempted Samsung&rsquo;s Bixby challenge based on NLP and were 2nd runner-up.</p>

  </div>

  <footer class="post-footer">
<nav class="paginav">
  <a class="prev" href="https://scholarstree.github.io/posts/2019-06-05-training-policy-gradients/2019-06-05-training-policy-gradients/">
    <span class="title">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left" style="user-select: text;"><line x1="19" y1="12" x2="5" y2="12" style="user-select: text;"></line><polyline points="12 19 5 12 12 5" style="user-select: text;"></polyline></svg>&nbsp;Prev Page</span>
    <br>
    <span>Training Policy Gradients</span>
  </a>
  <a class="next" href="https://scholarstree.github.io/posts/2018-03-10-beginners-guide-to-assembling-a-drone/2018-03-10-beginners-guide-to-assembling-a-drone/">
    <span class="title">Next Page&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right" style="user-select: text;"><line x1="5" y1="12" x2="19" y2="12" style="user-select: text;"></line><polyline points="12 5 19 12 12 19" style="user-select: text;"></polyline></svg>
    </span>
    <br>
    <span>A Student&#39;s Guide to Assembling a Quadcopter</span>
  </a>
</nav>

  </footer><div class="comments-box">
  <div id="disqus_thread"></div>
</div>

<script type="text/javascript">
  var disqus_config = function () {
    this.page.url = 'https:\/\/scholarstree.github.io\/posts\/2018-04-27-tharoor-it\/2018-04-27-tharoor-it\/';  
    this.page.identifier = '2018-04-27-tharoor-it'; 
  };

  (function () {
    const disqus = window.DISQUS
    if (disqus) {
      
      
      disqus.reset({
        reload: true,
        config: disqus_config,
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = '//' + 'scholarstree' + '.disqus.com/embed.js';
      s.defer = true;
      s.setAttribute('data-timestamp', +new Date());
      
      s.setAttribute('data-no-instant', '')
      d.head.appendChild(s);
    }
  })();
</script>

</article>
    </main>
    
<footer class="footer">
  <span>&copy; 2023 <a href="https://scholarstree.github.io/">Scholarstree</a></span><span style="display: inline-block; margin-left: 1em;">
    <a href="https://creativecommons.org/licenses/by-sa/4.0/"></a>
  </span>
  <span style="display: inline-block; margin-left: 1em;">
    Powered by
    <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
    <a href="https://github.com/reorx/hugo-PaperModX/" rel="noopener" target="_blank">PaperModX</a>
  </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
    <path d="M12 6H0l6-6z" />
  </svg>
</a>

<script>
  (function() {
     
    const disableThemeToggle = '' == '1';
    if (disableThemeToggle) {
      return;
    }

    let button = document.getElementById("theme-toggle")
    
    button.removeEventListener('click', toggleThemeListener)
    
    button.addEventListener('click', toggleThemeListener)
  })();
</script>

<script>
  (function () {
    let menu = document.getElementById('menu')
    if (menu) {
      menu.scrollLeft = localStorage.getItem("menu-scroll-position");
      menu.onscroll = function () {
        localStorage.setItem("menu-scroll-position", menu.scrollLeft);
      }
    }

    const disableSmoothScroll = '' == '1';
    const enableInstantClick = '1' == '1';
    
    if (window.matchMedia('(prefers-reduced-motion: reduce)').matches || disableSmoothScroll || enableInstantClick) {
      return;
    }
    
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener("click", function (e) {
        e.preventDefault();
        var id = this.getAttribute("href").substr(1);
        document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
          behavior: "smooth"
        });
        if (id === "top") {
          history.replaceState(null, null, " ");
        } else {
          history.pushState(null, null, `#${id}`);
        }
      });
    });
  })();
</script>
<script>
  var mybutton = document.getElementById("top-link");
  window.onscroll = function () {
    if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
      mybutton.style.visibility = "visible";
      mybutton.style.opacity = "1";
    } else {
      mybutton.style.visibility = "hidden";
      mybutton.style.opacity = "0";
    }
  };
</script>
<script>
  if (window.scrollListeners) {
    
    for (const listener of scrollListeners) {
      window.removeEventListener('scroll', listener)
    }
  }
  window.scrollListeners = []
</script>



<script src="/js/medium-zoom.min.js" data-no-instant
></script>
<script>
  document.querySelectorAll('pre > code').forEach((codeblock) => {
    const container = codeblock.parentNode.parentNode;

    const copybutton = document.createElement('button');
    copybutton.classList.add('copy-code');
    copybutton.innerText = 'copy';

    function copyingDone() {
      copybutton.innerText = 'copied!';
      setTimeout(() => {
        copybutton.innerText = 'copy';
      }, 2000);
    }

    copybutton.addEventListener('click', (cb) => {
      if ('clipboard' in navigator) {
        navigator.clipboard.writeText(codeblock.textContent);
        copyingDone();
        return;
      }

      const range = document.createRange();
      range.selectNodeContents(codeblock);
      const selection = window.getSelection();
      selection.removeAllRanges();
      selection.addRange(range);
      try {
        document.execCommand('copy');
        copyingDone();
      } catch (e) { };
      selection.removeRange(range);
    });

    if (container.classList.contains("highlight")) {
      container.appendChild(copybutton);
    } else if (container.parentNode.firstChild == container) {
      
    } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
      
      codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
    } else {
      
      codeblock.parentNode.appendChild(copybutton);
    }
  });
</script>




<script>
  
  
  (function() {
    const enableTocScroll = '1' == '1'
    if (!enableTocScroll) {
      return
    }
    if (!document.querySelector('.toc')) {
      console.log('no toc found, ignore toc scroll')
      return
    }
    

    
    const scrollListeners = window.scrollListeners
    const headings = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id]');
    const activeClass = 'active';

    
    let activeHeading = headings[0];
    getLinkByHeading(activeHeading).classList.add(activeClass);

    const onScroll = () => {
      const passedHeadings = [];
      for (const h of headings) {
        
        if (getOffsetTop(h) < 5) {
          passedHeadings.push(h)
        } else {
          break;
        }
      }
      if (passedHeadings.length > 0) {
        newActiveHeading = passedHeadings[passedHeadings.length - 1];
      } else {
        newActiveHeading = headings[0];
      }
      if (activeHeading != newActiveHeading) {
        getLinkByHeading(activeHeading).classList.remove(activeClass);
        activeHeading = newActiveHeading;
        getLinkByHeading(activeHeading).classList.add(activeClass);
      }
    }

    let timer = null;
    const scrollListener = () => {
      if (timer !== null) {
        clearTimeout(timer)
      }
      timer = setTimeout(onScroll, 50)
    }
    window.addEventListener('scroll', scrollListener, false);
    scrollListeners.push(scrollListener)

    function getLinkByHeading(heading) {
      const id = encodeURI(heading.getAttribute('id')).toLowerCase();
      return document.querySelector(`.toc ul li a[href="#${id}"]`);
    }

    function getOffsetTop(heading) {
      if (!heading.getClientRects().length) {
        return 0;
      }
      let rect = heading.getBoundingClientRect();
      return rect.top
    }
  })();
  </script>
<script>
  mediumZoom('.entry-cover img');
  mediumZoom('.post-content img:not([no-zoom])');
</script>

<script src="/js/instantclick.min.js" data-no-instant
></script>
<script data-no-instant>
  
  
  
  
  
  
  InstantClick.init();
</script>
</body>

</html>
